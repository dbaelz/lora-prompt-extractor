# LoRA Prompt Extractor
Command line tool to extract the positive prompts from PNG images created with [ComfyUI](https://github.com/comfyanonymous/ComfyUI) and then create text files for LoRA training with [kohya_ss](https://github.com/bmaltais/kohya_ss)

## Features
- Extracts positive prompts from PNG images generated by ComfyUI.
- Cleans prompts for LoRA training:
	- Removes parentheses, brackets, and braces (e.g., (tag), [tag], {tag})
	- Removes weights from prompts (e.g., (tag:1.5) to tag)
	- Collapses extra spaces and commas
	- Trims leading/trailing punctuation and whitespace
- Creates .txt files for each image, ready for LoRA training with kohya_ss.
- Supports removal of unwanted words or phrases from prompts (case-insensitive). Accepts multiple words or phrases to remove, either as separate arguments or as a comma-separated list.
- Optionally exports a summary file (`summary.csv`) with all image filenames and the .txt file descriptions using the `--summary` or `-s` flag.
- Debug mode (`--debug` or `-d`) prints the number of PNG files found, each image's metadata, and the final prompt written to file.

## Example usage
Extract prompts from all PNG images in a folder:

```bash
python src/main.py /path/to/image_folder
```

Remove specific words or phrases from the extracted prompts:

```bash
python src/main.py /path/to/image_folder --words-to-remove "Photorealistic, Natural atmospheric lighting, intricate details"
```

Or pass multiple phrases as separate arguments:
```bash
python src/main.py /path/to/image_folder --words-to-remove "Photorealistic" "Natural atmospheric lighting" "intricate details"
```


Export a summary file with all filenames and their final prompts:

```bash
python src/main.py /path/to/image_folder --summary
```

The resulting .txt files (and optional summary.txt) will be created in the same folder as the images, with the specified words/phrases removed from each prompt.

## Contribution
Feel free to contribute via pull requests.

## License
The project is licensed by the [Apache 2 license](LICENSE).